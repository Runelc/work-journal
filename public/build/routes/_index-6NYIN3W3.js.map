{
  "version": 3,
  "sources": ["../../../app/routes/_index.jsx", "../../../app/components/EntryListItem.jsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/_index.jsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/_index.jsx\");\n  import.meta.hot.lastModified = \"1708967144876.6926\";\n}\n// REMIX HMR END\n\nimport { json } from \"@remix-run/node\";\nimport { useLoaderData } from \"@remix-run/react\";\nimport mongoose from \"mongoose\";\nimport { useFetcher } from \"@remix-run/react\";\nimport { startOfWeek, format } from \"date-fns\";\nimport { Link } from \"@remix-run/react\";\nimport EntryListItem from \"../components/EntryListItem\";\nimport { getSession } from \"~/session\";\nexport async function loader({\n  request\n}) {\n  const session = await getSession(request.headers.get(\"Cookie\"));\n  const Entry = mongoose.model(\"Entry\");\n  const entries = await Entry.find();\n  const formattedEntries = entries.map(entry => ({\n    ...entry.toObject(),\n    date: entry.date.toISOString().substring(0, 10)\n  }));\n  return {\n    session: session.data,\n    entries: formattedEntries\n  };\n}\nexport default function Index() {\n  _s();\n  let {\n    session,\n    entries\n  } = useLoaderData();\n  const fetcher = useFetcher();\n  const entriesByWeek = entries.reduce((acc, entry) => {\n    const weekStart = format(startOfWeek(new Date(entry.date)), \"yyyy-MM-dd\");\n    if (!acc[weekStart]) {\n      acc[weekStart] = [];\n    }\n    acc[weekStart].push(entry);\n    return acc;\n  }, {});\n  return <div className=\"p-8 text-slate-50 bg-slate-900\">\n      {session.isAdmin && <fetcher.Form method=\"post\">\n          <fieldset className=\"disabled:opacity-70\" disabled={fetcher.state === \"submitting\"}>\n            <div>\n              <label htmlFor=\"date\">Date</label>\n              <input type=\"date\" id=\"date\" name=\"date\" required />\n            </div>\n            <div>\n              <label htmlFor=\"type\">Type</label>\n              <select id=\"type\" name=\"type\" required>\n                <option value=\"work\">Work</option>\n                <option value=\"learning\">Learning</option>\n                <option value=\"interesting-thing\">Interesting Thing</option>\n              </select>\n            </div>\n            <div>\n              <label htmlFor=\"text\">Text</label>\n              <textarea id=\"text\" name=\"text\" required />\n            </div>\n            <button type=\"submit\" disabled={fetcher.state === \"submitting\"}>\n              {fetcher.state === \"submitting\" ? \"Saving...\" : \"Save\"}\n            </button>\n          </fieldset>\n        </fetcher.Form>}\n      <code>\n        {Object.entries(entriesByWeek).map(([weekStart, entries]) => <div key={weekStart}>\n            <h2>Week of {weekStart}</h2>\n            {entries.map(entry => <EntryListItem key={entry.id} entry={entry} canEdit={session.isAdmin} />)}\n          </div>)}\n      </code>\n    </div>;\n}\n_s(Index, \"bi0GI/+SCQlbl/vNKE7lMdYc1jA=\", false, function () {\n  return [useLoaderData, useFetcher];\n});\n_c = Index;\nexport const action = async ({\n  request\n}) => {\n  let session = await getSession(request.headers.get(\"cookie\"));\n  if (!session.data.isAdmin) {\n    throw new Response(\"Not authenticated\", {\n      status: 401,\n      statusText: \"Not authenticated\"\n    });\n  }\n  const formData = await request.formData();\n  const {\n    date,\n    type,\n    text\n  } = Object.fromEntries(formData);\n  await new Promise(resolve => setTimeout(resolve, 1000));\n  if (typeof date !== \"string\" || typeof type !== \"string\" || typeof text !== \"string\") {\n    throw new Error(\"Bad request\");\n  }\n  return await mongoose.models.Entry.create({\n    date,\n    type,\n    text\n  });\n};\nvar _c;\n$RefreshReg$(_c, \"Index\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;", "// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/components/EntryListItem.jsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/components/EntryListItem.jsx\");\n  import.meta.hot.lastModified = \"1708948635702.6975\";\n}\n// REMIX HMR END\n\nimport { Link } from \"@remix-run/react\";\nfunction EntryListItem({\n  entry,\n  canEdit\n}) {\n  return <li className=\"group\">\n      {entry.text}\n\n      {canEdit && <Link to={`/entries/${entry._id}/edit`} className=\"ml-2 text-blue-500 opacity-0 group-hover:opacity-100\">\n          Edit\n        </Link>}\n    </li>;\n}\n_c = EntryListItem;\nexport default EntryListItem;\nvar _c;\n$RefreshReg$(_c, \"EntryListItem\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": ["import_jsx_dev_runtime", "entries", "_c", "_c"]
}
